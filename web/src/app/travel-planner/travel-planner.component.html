<div class="planner-container">
  <div class="planner-header">
    <h1>Journey Planner</h1>
    <p>Plan and organize your adventures all in one place</p>
  </div>

  <div class="planner-actions">
    <button class="create-button" (click)="showNewJourneyForm = true" *ngIf="!showNewJourneyForm">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
      </svg>
      Create New Journey
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>Loading your journey plans...</p>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error">
    <div class="error-icon">
      <svg viewBox="0 0 24 24" width="48" height="48">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
      </svg>
    </div>
    <h3>Oops! Something went wrong</h3>
    <p>{{ error }}</p>
    <button class="retry-button" (click)="loadJourneys()">Try Again</button>
  </div>

  <!-- New Journey Form -->
  <div class="new-journey-form" *ngIf="showNewJourneyForm">
    <h2>Create New Journey</h2>
    <form [formGroup]="journeyForm" (ngSubmit)="createJourney()">
      <div class="form-row">
        <div class="form-group">
          <label for="journeyName">Journey Name</label>
          <input type="text" id="journeyName" formControlName="name" class="form-control">
          <div class="error-message" *ngIf="submitted && f['name'].errors">
            <div *ngIf="f['name'].errors['required']">Journey name is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="destination">Destination</label>
          <input type="text" id="destination" formControlName="destination" class="form-control">
          <div class="error-message" *ngIf="submitted && f['destination'].errors">
            <div *ngIf="f['destination'].errors['required']">Destination is required</div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="startDate">Start Date</label>
          <input type="date" id="startDate" formControlName="startDate" class="form-control">
          <div class="error-message" *ngIf="submitted && f['startDate'].errors">
            <div *ngIf="f['startDate'].errors['required']">Start date is required</div>
          </div>
        </div>

        <div class="form-group">
          <label for="endDate">End Date</label>
          <input type="date" id="endDate" formControlName="endDate" class="form-control">
          <div class="error-message" *ngIf="submitted && f['endDate'].errors">
            <div *ngIf="f['endDate'].errors['required']">End date is required</div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="budget">Budget (USD)</label>
          <input type="number" id="budget" formControlName="budget" class="form-control">
        </div>

        <div class="form-group">
          <label for="travelers">Number of Travelers</label>
          <input type="number" id="travelers" formControlName="travelers" class="form-control">
        </div>
      </div>

      <div class="form-group full-width">
        <label for="notes">Notes</label>
        <textarea id="notes" formControlName="notes" class="form-control textarea"></textarea>
      </div>

      <div class="journey-theme">
        <h3>Journey Theme</h3>
        <p>Select a theme to get personalized experience recommendations</p>
        <div class="theme-options">
          <div class="theme-option" *ngFor="let theme of journeyThemes">
            <input type="radio" [id]="'theme-' + theme.id" [value]="theme.id" formControlName="theme">
            <label [for]="'theme-' + theme.id">
              <span class="theme-icon" [innerHTML]="theme.icon"></span>
              <span class="theme-name">{{ theme.name }}</span>
            </label>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="cancelNewJourney()">Cancel</button>
        <button type="submit" class="save-button" [disabled]="formSubmitting">
          <span *ngIf="formSubmitting" class="spinner-small"></span>
          Create Journey
        </button>
      </div>
    </form>
  </div>

  <!-- Journey List -->
  <div class="journey-list" *ngIf="!showNewJourneyForm && journeys.length > 0 && !loading">
    <div class="journey-card" *ngFor="let journey of journeys">
      <div class="journey-header">
        <h3>{{ journey.name }}</h3>
        <div class="journey-dates">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19a2 2 0 002 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7v-5z"/>
          </svg>
          {{ journey.startDate | date:'mediumDate' }} - {{ journey.endDate | date:'mediumDate' }}
        </div>
      </div>

      <div class="journey-destination">
        <svg viewBox="0 0 24 24" width="18" height="18">
          <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
        </svg>
        {{ journey.destination }}
      </div>

      <div class="journey-budget">
        <svg viewBox="0 0 24 24" width="18" height="18">
          <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
        </svg>
        ${{ journey.totalBudget }}
      </div>

      <div class="journey-theme" *ngIf="journey.theme">
        <span class="theme-tag">{{ journey.theme }}</span>
      </div>

      <div class="journey-stats">
        <div class="stat-item">
          <div class="stat-value">{{ journey.activities.length }}</div>
          <div class="stat-label">Activities</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">{{ journey.accommodations.length }}</div>
          <div class="stat-label">Stays</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">{{ journey.transportation.length }}</div>
          <div class="stat-label">Transport</div>
        </div>
      </div>

      <div class="journey-progress">
        <div class="progress-label">Journey planning progress</div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width]="getJourneyProgress(journey) + '%'"></div>
        </div>
        <div class="progress-value">{{ getJourneyProgress(journey) }}%</div>
      </div>

      <div class="journey-actions">
        <button class="view-button" (click)="viewJourney(journey.id)">View Details</button>
        <button class="edit-button" (click)="editJourney(journey.id)">Edit</button>
        <button class="delete-button" (click)="deleteJourney(journey.id)">Delete</button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!showNewJourneyForm && journeys.length === 0 && !loading && !error">
    <div class="empty-illustration">
      <svg viewBox="0 0 24 24" width="64" height="64">
        <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
      </svg>
    </div>
    <h2>No journeys planned yet</h2>
    <p>Start creating your adventure itineraries and keep all your plans organized in one place.</p>
    <button class="create-button" (click)="showNewJourneyForm = true">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
      </svg>
      Create Your First Journey
    </button>
  </div>

  <!-- Journey Detail View -->
  <div class="journey-detail" *ngIf="selectedJourney">
    <div class="detail-header">
      <div class="header-content">
        <h2>{{ selectedJourney.name }}</h2>
        <p class="detail-dates">{{ selectedJourney.startDate | date:'mediumDate' }} - {{ selectedJourney.endDate | date:'mediumDate' }}</p>
        <p class="detail-location">{{ selectedJourney.destination }}</p>
        <div class="detail-theme" *ngIf="selectedJourney.theme">
          <span class="theme-tag">{{ selectedJourney.theme }}</span>
        </div>
      </div>
      <button class="close-button" (click)="closeDetail()">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
    </div>

    <mat-tab-group>
      <mat-tab label="Overview">
        <div class="overview-content">
          <div class="budget-tracker">
            <h3>Budget Tracker</h3>
            <div class="budget-progress">
              <div class="budget-bar">
                <div class="budget-spent" [style.width]="(totalSpent / selectedJourney.totalBudget * 100) + '%'"></div>
              </div>
              <div class="budget-stats">
                <div class="budget-total">
                  <span>Total Budget:</span>
                  <span>${{ selectedJourney.totalBudget }}</span>
                </div>
                <div class="budget-spent">
                  <span>Spent So Far:</span>
                  <span>${{ totalSpent }}</span>
                </div>
                <div class="budget-remaining" [ngClass]="{'over-budget': totalSpent > selectedJourney.totalBudget}">
                  <span>Remaining:</span>
                  <span>${{ selectedJourney.totalBudget - totalSpent }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="journey-summary">
            <h3>Journey Summary</h3>
            <div class="summary-grid">
              <div class="summary-card">
                <h4>Duration</h4>
                <p>{{ journeyDuration }} days</p>
              </div>
              <div class="summary-card">
                <h4>Activities</h4>
                <p>{{ selectedJourney.activities.length }} planned</p>
              </div>
              <div class="summary-card">
                <h4>Accommodations</h4>
                <p>{{ selectedJourney.accommodations.length }} booked</p>
              </div>
              <div class="summary-card">
                <h4>Transportation</h4>
                <p>{{ selectedJourney.transportation.length }} booked</p>
              </div>
            </div>
          </div>

          <div class="recommended-experiences" *ngIf="recommendedExperiences.length > 0">
            <h3>Recommended Experiences</h3>
            <p>Based on your journey theme and destination</p>

            <div class="experiences-grid">
              <div class="experience-card" *ngFor="let experience of recommendedExperiences">
                <div class="experience-image">
                  <img [src]="experience.image" alt="{{ experience.title }}">
                  <div class="experience-price">{{ experience.price }}</div>
                </div>
                <div class="experience-details">
                  <h4>{{ experience.title }}</h4>
                  <p class="experience-location">{{ experience.location }}</p>
                  <div class="experience-rating" *ngIf="experience.rating">
                    <span class="star-icon">★</span>
                    <span>{{ experience.rating }}</span>
                  </div>
                  <button class="add-experience-button" (click)="addToJourney(experience.id)">
                    Add to Journey
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="notes-section" *ngIf="selectedJourney.notes">
            <h3>Journey Notes</h3>
            <div class="notes-content">
              {{ selectedJourney.notes }}
            </div>
          </div>

          <div class="journey-timeline">
            <h3>Journey Timeline</h3>
            <div class="timeline">
              <div class="timeline-item" *ngFor="let day of journeyDays; let i = index">
                <div class="timeline-date">
                  <div class="date-marker">{{ i + 1 }}</div>
                  <div class="date-details">
                    <div class="date-day">{{ day | date:'EEEE' }}</div>
                    <div class="date-full">{{ day | date:'mediumDate' }}</div>
                  </div>
                </div>
                <div class="timeline-events">
                  <div class="timeline-event transport" *ngFor="let transport of getTransportationForDay(day)">
                    <div class="event-time">{{ transport.departureTime }}</div>
                    <div class="event-type">{{ transport.type | titlecase }}</div>
                    <div class="event-details">
                      {{ transport.from }} to {{ transport.to }}
                      <div class="event-sub">{{ transport.carrier }}</div>
                    </div>
                  </div>
                  <div class="timeline-event accommodation" *ngFor="let accommodation of getAccommodationForDay(day)">
                    <div class="event-time">Check-in</div>
                    <div class="event-type">Stay</div>
                    <div class="event-details">
                      {{ accommodation.name }}
                      <div class="event-sub">{{ accommodation.location }}</div>
                    </div>
                  </div>
                  <div class="timeline-event activity" *ngFor="let activity of getActivitiesForDay(day)">
                    <div class="event-time">{{ activity.time }}</div>
                    <div class="event-type">Experience</div>
                    <div class="event-details">
                      {{ activity.name }}
                      <div class="event-sub">{{ activity.location }}</div>
                    </div>
                  </div>
                  <div class="empty-day" *ngIf="!hasEventsForDay(day)">
                    No experiences planned for this day.
                    <button class="add-activity-button" (click)="addActivityForm(day)">Add Experience</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Experiences">
        <div class="experiences-content">
          <div class="section-header">
            <h3>Adventures & Experiences</h3>
            <button class="add-button" (click)="showActivityForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Experience
            </button>
          </div>

          <div class="experiences-form" *ngIf="showingActivityForm">
            <h4>{{ editingActivity ? 'Edit Experience' : 'Add New Experience' }}</h4>
            <form [formGroup]="activityForm" (ngSubmit)="saveActivity()">
              <div class="form-row">
                <div class="form-group">
                  <label for="activityName">Experience Name</label>
                  <input type="text" id="activityName" formControlName="name" class="form-control">
                </div>

                <div class="form-group">
                  <label for="activityDate">Date</label>
                  <input type="date" id="activityDate" formControlName="date" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="activityTime">Time</label>
                  <input type="time" id="activityTime" formControlName="time" class="form-control">
                </div>

                <div class="form-group">
                  <label for="activityLocation">Location</label>
                  <input type="text" id="activityLocation" formControlName="location" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="activityCost">Cost (USD)</label>
                  <input type="number" id="activityCost" formControlName="cost" class="form-control">
                </div>

                <div class="form-group">
                  <label for="activityType">Experience Type</label>
                  <select id="activityType" formControlName="type" class="form-control">
                    <option value="adventure">Adventure</option>
                    <option value="cultural">Cultural</option>
                    <option value="culinary">Culinary</option>
                    <option value="wellness">Wellness</option>
                    <option value="sightseeing">Sightseeing</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" formControlName="booked">
                  <span>Already Booked</span>
                </label>
              </div>

              <div class="form-group full-width">
                <label for="activityNotes">Notes</label>
                <textarea id="activityNotes" formControlName="notes" class="form-control textarea"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="cancel-button" (click)="cancelActivityForm()">Cancel</button>
                <button type="submit" class="save-button" [disabled]="formSubmitting">
                  <span *ngIf="formSubmitting" class="spinner-small"></span>
                  Save
                </button>
              </div>
            </form>
          </div>

          <div class="activities-list" *ngIf="!showingActivityForm && selectedJourney.activities.length > 0">
            <div class="activity-card" *ngFor="let activity of selectedJourney.activities">
              <div class="activity-icon" [ngClass]="activity.type || 'adventure'">
                <!-- Adventure Icon -->
                <svg *ngIf="activity.type === 'adventure'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/>
                </svg>
                <!-- Cultural Icon -->
                <svg *ngIf="activity.type === 'cultural'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"/>
                </svg>
                <!-- Default Icon -->
                <svg *ngIf="!activity.type || activity.type === 'other'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm2.19 12.19L6 18l3.81-8.19L18 6l-3.81 8.19z"/>
                </svg>
              </div>
              <div class="activity-info">
                <h4>{{ activity.name }}</h4>
                <p class="activity-datetime">
                  {{ activity.date | date:'mediumDate' }} at {{ activity.time }}
                </p>
                <p class="activity-location">{{ activity.location }}</p>
                <p class="activity-cost">${{ activity.cost }}</p>
                <div class="booking-status" *ngIf="activity.booked">Booked</div>
              </div>
              <div class="activity-actions">
                <button class="edit-button" (click)="editActivity(activity.id)">Edit</button>
                <button class="delete-button" (click)="deleteActivity(activity.id)">Delete</button>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!showingActivityForm && selectedJourney.activities.length === 0">
            <p>No experiences added yet. Start planning your adventures!</p>
            <button class="add-button" (click)="showActivityForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Experience
            </button>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Accommodations">
        <div class="accommodations-content">
          <div class="section-header">
            <h3>Accommodations</h3>
            <button class="add-button" (click)="showAccommodationForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Accommodation
            </button>
          </div>

          <div class="accommodation-form" *ngIf="showingAccommodationForm">
            <h4>{{ editingAccommodation ? 'Edit Accommodation' : 'Add New Accommodation' }}</h4>
            <form [formGroup]="accommodationForm" (ngSubmit)="saveAccommodation()">
              <div class="form-row">
                <div class="form-group">
                  <label for="accommodationName">Property Name</label>
                  <input type="text" id="accommodationName" formControlName="name" class="form-control">
                </div>

                <div class="form-group">
                  <label for="accommodationType">Type</label>
                  <select id="accommodationType" formControlName="type" class="form-control">
                    <option value="hotel">Hotel</option>
                    <option value="apartment">Apartment</option>
                    <option value="guesthouse">Guesthouse</option>
                    <option value="hostel">Hostel</option>
                    <option value="resort">Resort</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="accommodationLocation">Location</label>
                  <input type="text" id="accommodationLocation" formControlName="location" class="form-control">
                </div>

                <div class="form-group">
                  <label for="accommodationUrl">Booking URL (optional)</label>
                  <input type="text" id="accommodationUrl" formControlName="url" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="checkIn">Check-in Date</label>
                  <input type="date" id="checkIn" formControlName="checkIn" class="form-control">
                </div>

                <div class="form-group">
                  <label for="checkOut">Check-out Date</label>
                  <input type="date" id="checkOut" formControlName="checkOut" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="accommodationCost">Cost (USD)</label>
                  <input type="number" id="accommodationCost" formControlName="cost" class="form-control">
                </div>

                <div class="form-group">
                  <label for="confirmation">Confirmation Number</label>
                  <input type="text" id="confirmation" formControlName="confirmation" class="form-control">
                </div>
              </div>

              <div class="form-group full-width">
                <label for="accommodationNotes">Notes</label>
                <textarea id="accommodationNotes" formControlName="notes" class="form-control textarea"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="cancel-button" (click)="cancelAccommodationForm()">Cancel</button>
                <button type="submit" class="save-button" [disabled]="formSubmitting">
                  <span *ngIf="formSubmitting" class="spinner-small"></span>
                  Save
                </button>
              </div>
            </form>
          </div>

          <div class="accommodations-list" *ngIf="!showingAccommodationForm && selectedJourney.accommodations.length > 0">
            <div class="accommodation-card" *ngFor="let accommodation of selectedJourney.accommodations">
              <div class="accommodation-icon" [ngClass]="accommodation.type || 'hotel'">
                <!-- Hotel Icon -->
                <svg *ngIf="!accommodation.type || accommodation.type === 'hotel'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4z"/>
                </svg>
                <!-- Apartment Icon -->
                <svg *ngIf="accommodation.type === 'apartment'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M17 11V3H7v4H3v14h8v-4h2v4h8V11h-4zM7 19H5v-2h2v2zm0-4H5v-2h2v2zm0-4H5V9h2v2zm4 4H9v-2h2v2zm0-4H9V9h2v2zm0-4H9V5h2v2zm4 8h-2v-2h2v2zm0-4h-2V9h2v2zm0-4h-2V5h2v2zm4 12h-2v-2h2v2zm0-4h-2v-2h2v2z"/>
                </svg>
              </div>
              <div class="accommodation-info">
                <h4>{{ accommodation.name }}</h4>
                <p class="accommodation-location">{{ accommodation.location }}</p>
                <p class="accommodation-dates">
                  {{ accommodation.checkIn | date:'mediumDate' }} - {{ accommodation.checkOut | date:'mediumDate' }}
                </p>
                <p class="accommodation-cost">${{ accommodation.cost }}</p>
                <p class="accommodation-confirmation" *ngIf="accommodation.confirmation">
                  Confirmation #: {{ accommodation.confirmation }}
                </p>
              </div>
              <div class="accommodation-actions">
                <button class="edit-button" (click)="editAccommodation(accommodation.id)">Edit</button>
                <button class="delete-button" (click)="deleteAccommodation(accommodation.id)">Delete</button>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!showingAccommodationForm && selectedJourney.accommodations.length === 0">
            <p>No accommodations added yet. Where will you be staying?</p>
            <button class="add-button" (click)="showAccommodationForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Accommodation
            </button>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Transportation">
        <div class="transportation-content">
          <div class="section-header">
            <h3>Transportation</h3>
            <button class="add-button" (click)="showTransportationForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Transportation
            </button>
          </div>

          <div class="transportation-form" *ngIf="showingTransportationForm">
            <h4>{{ editingTransportation ? 'Edit Transportation' : 'Add New Transportation' }}</h4>
            <form [formGroup]="transportationForm" (ngSubmit)="saveTransportation()">
              <div class="form-row">
                <div class="form-group">
                  <label for="transportationType">Type</label>
                  <select id="transportationType" formControlName="type" class="form-control">
                    <option value="flight">Flight</option>
                    <option value="train">Train</option>
                    <option value="car">Car Rental</option>
                    <option value="bus">Bus</option>
                    <option value="ferry">Ferry</option>
                    <option value="other">Other</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="carrier">Carrier/Company</label>
                  <input type="text" id="carrier" formControlName="carrier" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="from">From</label>
                  <input type="text" id="from" formControlName="from" class="form-control">
                </div>

                <div class="form-group">
                  <label for="to">To</label>
                  <input type="text" id="to" formControlName="to" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="departureDate">Departure Date</label>
                  <input type="date" id="departureDate" formControlName="departureDate" class="form-control">
                </div>

                <div class="form-group">
                  <label for="departureTime">Departure Time</label>
                  <input type="time" id="departureTime" formControlName="departureTime" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="arrivalDate">Arrival Date</label>
                  <input type="date" id="arrivalDate" formControlName="arrivalDate" class="form-control">
                </div>

                <div class="form-group">
                  <label for="arrivalTime">Arrival Time</label>
                  <input type="time" id="arrivalTime" formControlName="arrivalTime" class="form-control">
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="transportationCost">Cost (USD)</label>
                  <input type="number" id="transportationCost" formControlName="cost" class="form-control">
                </div>

                <div class="form-group">
                  <label for="transportationConfirmation">Confirmation/Booking Reference</label>
                  <input type="text" id="transportationConfirmation" formControlName="confirmation" class="form-control">
                </div>
              </div>

              <div class="form-group full-width">
                <label for="transportationNotes">Notes</label>
                <textarea id="transportationNotes" formControlName="notes" class="form-control textarea"></textarea>
              </div>

              <div class="form-actions">
                <button type="button" class="cancel-button" (click)="cancelTransportationForm()">Cancel</button>
                <button type="submit" class="save-button" [disabled]="formSubmitting">
                  <span *ngIf="formSubmitting" class="spinner-small"></span>
                  Save
                </button>
              </div>
            </form>
          </div>

          <div class="transportation-list" *ngIf="!showingTransportationForm && selectedJourney.transportation.length > 0">
            <div class="transportation-card" *ngFor="let transport of selectedJourney.transportation">
              <div class="transportation-type" [ngClass]="transport.type">
                <!-- Flight Icon -->
                <svg *ngIf="transport.type === 'flight'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                </svg>
                <!-- Train Icon -->
                <svg *ngIf="transport.type === 'train'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M12 2c-4 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h2.23l2-2H14l2 2h2v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-3.58-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-7H6V6h5v4zm5.5 7c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-7h-5V6h5v4z"/>
                </svg>
                <!-- Car Icon -->
                <svg *ngIf="transport.type === 'car'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                </svg>
                <!-- Default/Other Icon -->
                <svg *ngIf="!transport.type || transport.type === 'other'" viewBox="0 0 24 24" width="24" height="24">
                  <path d="M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"/>
                </svg>
              </div>
              <div class="transportation-info">
                <h4>{{ transport.type | titlecase }}: {{ transport.from }} to {{ transport.to }}</h4>
                <p class="transport-carrier" *ngIf="transport.carrier">{{ transport.carrier }}</p>
                <p class="transport-datetime">
                  {{ transport.departureDate | date:'mediumDate' }} at {{ transport.departureTime }}
                  <span class="arrow">→</span>
                  {{ transport.arrivalDate | date:'mediumDate' }} at {{ transport.arrivalTime }}
                </p>
                <p class="transport-cost">${{ transport.cost }}</p>
                <p class="transport-confirmation" *ngIf="transport.confirmation">
                  Confirmation #: {{ transport.confirmation }}
                </p>
              </div>
              <div class="transportation-actions">
                <button class="edit-button" (click)="editTransportation(transport.id)">Edit</button>
                <button class="delete-button" (click)="deleteTransportation(transport.id)">Delete</button>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!showingTransportationForm && selectedJourney.transportation.length === 0">
            <p>No transportation added yet. How will you get there?</p>
            <button class="add-button" (click)="showTransportationForm()">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
              </svg>
              Add Transportation
            </button>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Packing List">
        <div class="packing-list-content">
          <div class="section-header">
            <h3>Packing List</h3>
            <div class="packing-actions">
              <button class="add-button" (click)="showPackingItemForm()">
                <svg viewBox="0 0 24 24" width="16" height="16">
                  <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
                Add Item
              </button>
              <button class="template-button" (click)="usePackingTemplate()">
                <svg viewBox="0 0 24 24" width="16" height="16">
                  <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"/>
                </svg>
                Use Template
              </button>
            </div>
          </div>

          <div class="packing-form" *ngIf="showingPackingItemForm">
            <h4>Add Packing Item</h4>
            <form [formGroup]="packingItemForm" (ngSubmit)="savePackingItem()">
              <div class="form-row">
                <div class="form-group">
                  <label for="itemName">Item Name</label>
                  <input type="text" id="itemName" formControlName="name" class="form-control">
                </div>

                <div class="form-group">
                  <label for="itemCategory">Category</label>
                  <select id="itemCategory" formControlName="category" class="form-control">
                    <option value="essentials">Essentials</option>
                    <option value="clothing">Clothing</option>
                    <option value="toiletries">Toiletries</option>
                    <option value="electronics">Electronics</option>
                    <option value="documents">Documents</option>
                    <option value="gear">Adventure Gear</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="itemQuantity">Quantity</label>
                  <input type="number" id="itemQuantity" formControlName="quantity" class="form-control">
                </div>

                <div class="form-group">
                  <label class="checkbox-label">
                    <input type="checkbox" formControlName="packed">
                    <span>Already Packed</span>
                  </label>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="cancel-button" (click)="cancelPackingItemForm()">Cancel</button>
                <button type="submit" class="save-button" [disabled]="formSubmitting">
                  <span *ngIf="formSubmitting" class="spinner-small"></span>
                  Save
                </button>
              </div>
            </form>
          </div>

          <div class="packing-categories" *ngIf="!showingPackingItemForm">
            <div class="packing-category" *ngFor="let category of packingCategories">
              <div class="category-header" (click)="toggleCategory(category.id)">
                <h4>
                  <svg viewBox="0 0 24 24" width="18" height="18" *ngIf="category.id === 'essentials'">
                    <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                  </svg>
                  {{ category.name }}
                  <span class="item-count">{{ getCategoryCount(category.id) }} items</span>
                </h4>
                <span class="category-progress">{{ getCategoryProgress(category.id) }}%</span>
                <svg viewBox="0 0 24 24" width="18" height="18" class="toggle-icon" [class.rotated]="!category.isCollapsed">
                  <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
                </svg>
              </div>

              <div class="category-items" [ngClass]="{'collapsed': category.isCollapsed}">
                <div class="packing-item" *ngFor="let item of getItemsByCategory(category.id)">
                  <div class="item-check">
                    <input type="checkbox" [id]="'item-' + item.id" [(ngModel)]="item.packed" (change)="updatePackingItem(item)">
                    <label [for]="'item-' + item.id"></label>
                  </div>
                  <div class="item-details">
                    <span class="item-name" [class.packed]="item.packed">{{ item.name }}</span>
                    <span class="item-quantity" *ngIf="item.quantity > 1">x{{ item.quantity }}</span>
                  </div>
                  <div class="item-actions">
                    <button class="item-edit" (click)="editPackingItem(item.id)">
                      <svg viewBox="0 0 24 24" width="16" height="16">
                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                      </svg>
                    </button>
                    <button class="item-delete" (click)="deletePackingItem(item.id)">
                      <svg viewBox="0 0 24 24" width="16" height="16">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <div class="empty-category" *ngIf="getItemsByCategory(category.id).length === 0">
                  <p>No items in this category.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="empty-state" *ngIf="!showingPackingItemForm && getTotalPackingItems() === 0">
            <svg viewBox="0 0 24 24" width="48" height="48">
              <path d="M18 6h-2c0-2.21-1.79-4-4-4S8 3.79 8 6H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-8 4c0 .55-.45 1-1 1s-1-.45-1-1V8h2v2zm3 0c0 .55-.45 1-1 1s-1-.45-1-1V8h2v2zm3 0c0 .55-.45 1-1 1s-1-.45-1-1V8h2v2z"/>
            </svg>
            <p>Your packing list is empty. Start adding items or use a template.</p>
            <div class="empty-actions">
              <button class="add-button" (click)="showPackingItemForm()">
                <svg viewBox="0 0 24 24" width="16" height="16">
                  <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
                Add Item
              </button>
              <button class="template-button" (click)="usePackingTemplate()">
                <svg viewBox="0 0 24 24" width="16" height="16">
                  <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"/>
                </svg>
                Use Template
              </button>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
